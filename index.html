<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Objects Playground</title>

    <!-- Link CSS, JS, and WebGL -->
    <!-- webgl-utils.js	: standard utilities from Google to set up a WebGL context -->
    <!-- initShaders.js	: contains helper functions to compile and link WebGL shaders to the application -->
    <!-- MV.js			: provides matrix and vector manipulation functions APIs for WebGL -->
    <!-- DemoJS.js		: your JS file -->
    <!-- DemoCSS.css	: your CSS file -->
    <script type="text/javascript" src="Common/webgl-utils.js"></script>
    <script type="text/javascript" src="Common/initShaders.js"></script>
    <script type="text/javascript" src="Common/MV.js"></script>
    <script type="text/javascript" src="Geometry/Cube.js"></script>
    <script type="text/javascript" src="Geometry/Cylinder.js"></script>
    <script type="text/javascript" src="Geometry/Sphere.js"></script>
    <script type="text/javascript" src="Geometry/Teapot.js"></script>
    <script type="text/javascript" src="Variables.js"></script>
    <script type="text/javascript" src="Main.js"></script>
    <script type="text/javascript" src="Lighting.js"></script>
    <script type="text/javascript" src="Material.js"></script>
    <script type="text/javascript" src="Camera.js"></script>
    <script type="text/javascript" src="Shading.js"></script>
    <script type="text/javascript" src="ConfigureWebGL.js"></script>

    <link rel="icon" type="image/png" href="images/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Define the vertex shader -->
    <script id="vertex-shader" type="x-shader/x-vertex">
      precision mediump float;
      uniform mat4 projectionMatrix;
      uniform mat4 modelViewMatrix;
      uniform mat3 normalMatrix;
      uniform vec4 ambientProduct;
      uniform vec4 diffuseProduct;
      uniform vec4 specularProduct;
      uniform vec4 lightPos;
      uniform float shininess;
      uniform vec3 spotlightDir;       // Add spotlight direction
      uniform float spotlightCutoff;   // Add cutoff angle
      uniform bool isSpotlight;        // Add spotlight flag

      attribute vec4 vPosition;
      attribute vec3 vNormal;
      varying vec4 fColor;
      attribute vec2 vTexCoord;
      varying vec2 fTexCoord;

      void main() {
          fTexCoord = vTexCoord;
          vec3 pos = (modelViewMatrix * vPosition).xyz;
          vec3 L;

          if(lightPos.w == 0.0) {
              L = normalize(lightPos.xyz);
          } else {
              L = normalize(lightPos.xyz - pos);
          }

          vec3 E = -normalize(pos);
          vec3 H = normalize(L + E);
          vec3 N = normalize(normalMatrix * vNormal);

          // Spotlight calculations
          float spotEffect = 1.0;
          if(isSpotlight && lightPos.w == 1.0) {
              vec3 spotDir = normalize(spotlightDir);
              float cosTheta = dot(-L, spotDir);
              float cutoff = cos(radians(spotlightCutoff));

              if(cosTheta < cutoff) {
                  spotEffect = 0.0;
              } else {
                  spotEffect = pow(cosTheta, 50.0); // Add spotlight exponent
              }
          } else {
              spotEffect = 1.0;
          }

          vec4 ambient = ambientProduct;
          float Kd = max(dot(L, N), 0.0);
          vec4 diffuse = Kd * diffuseProduct * spotEffect;
          float Ks = pow(max(dot(N, H), 0.0), shininess);
          vec4 specular = Ks * specularProduct * spotEffect;

          if(dot(L, N) < 0.0) {
              specular = vec4(0.0);
          }

          gl_Position = projectionMatrix * modelViewMatrix * vPosition;
          fColor = ambient + diffuse + specular;
          fColor.a = 1.0;
      }
    </script>

    <!-- Define the fragment shader -->
    <script id="fragment-shader" type="x-shader/x-fragment">
      precision mediump float;
      varying vec4 fColor;
      varying vec2 fTexCoord;
      uniform sampler2D uTexture;
      uniform bool uUseTexture;

      void main()
      {
        vec4 textureColor = texture2D(uTexture, fTexCoord);
        vec4 finalColor = uUseTexture ? textureColor * fColor : fColor;
        gl_FragColor = finalColor;
      }
    </script>
  </head>

  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- Canvas for the graphic rendering -->
        <div class="col-lg-8 col-md-12 mb-4">
          <div class="canvas">
            <canvas id="gl-canvas" width="1280" height="720">
              Error: your browser doesn't support the HTML5 canvas element
            </canvas>
          </div>
        </div>

        <!-- Control Panel -->
        <div class="col-lg-4 col-md-12">
          <div class="panel vertical-align">
            <!-- Object Controls -->
            <div class="accordion" id="objectControls">
              <!-- Cylinder Controls -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="cylinderHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#cylinderCollapse"
                    aria-expanded="false"
                    aria-controls="cylinderCollapse"
                  >
                    Cylinder Controls
                  </button>
                </h2>
                <div
                  id="cylinderCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="cylinderHeading"
                  data-bs-parent="#objectControls"
                >
                  <div class="accordion-body">
                    <!-- Radio buttons for cylinder animation -->
                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate X-Axis</div>
                      <input
                        class="checkRadio"
                        id="cylinder-x"
                        type="radio"
                        name="checkCylinder"
                        checked
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Y-Axis</div>
                      <input
                        class="checkRadio"
                        id="cylinder-y"
                        type="radio"
                        name="checkCylinder"
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Z-Axis</div>
                      <input
                        class="checkRadio"
                        id="cylinder-z"
                        type="radio"
                        name="checkCylinder"
                      />
                    </div>

                    <!-- Cylinder animation button -->
                    <input
                      id="cylinder-btn"
                      class="anim-btn"
                      type="button"
                      value="Toggle Cylinder"
                    />
                  </div>
                </div>
              </div>

              <!-- Teapot Controls -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="teapotHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#teapotCollapse"
                    aria-expanded="false"
                    aria-controls="teapotCollapse"
                  >
                    Teapot Controls
                  </button>
                </h2>
                <div
                  id="teapotCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="teapotHeading"
                  data-bs-parent="#objectControls"
                >
                  <div class="accordion-body">
                    <!-- Radio buttons for teapot animation -->
                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate X-Axis</div>
                      <input
                        class="checkRadio"
                        id="teapot-x"
                        type="radio"
                        name="checkTeapot"
                        checked
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Y-Axis</div>
                      <input
                        class="checkRadio"
                        id="teapot-y"
                        type="radio"
                        name="checkTeapot"
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Z-Axis</div>
                      <input
                        class="checkRadio"
                        id="teapot-z"
                        type="radio"
                        name="checkTeapot"
                      />
                    </div>

                    <!-- Teapot animation button -->
                    <input
                      id="teapot-btn"
                      class="anim-btn"
                      type="button"
                      value="Toggle Teapot"
                    />
                  </div>
                </div>
              </div>

              <!-- Cube Controls -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="cubeHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#cubeCollapse"
                    aria-expanded="false"
                    aria-controls="cubeCollapse"
                  >
                    Cube Controls
                  </button>
                </h2>
                <div
                  id="cubeCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="cubeHeading"
                  data-bs-parent="#objectControls"
                >
                  <div class="accordion-body">
                    <!-- Radio buttons for cube animation -->
                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate X-Axis</div>
                      <input
                        class="checkRadio"
                        id="cube-x"
                        type="radio"
                        name="checkCube"
                        checked
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Y-Axis</div>
                      <input
                        class="checkRadio"
                        id="cube-y"
                        type="radio"
                        name="checkCube"
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Z-Axis</div>
                      <input
                        class="checkRadio"
                        id="cube-z"
                        type="radio"
                        name="checkCube"
                      />
                    </div>

                    <!-- Cube animation button -->
                    <input
                      id="cube-btn"
                      class="anim-btn"
                      type="button"
                      value="Toggle Cube"
                    />
                  </div>
                </div>
              </div>

              <!-- Sphere Controls -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="sphereHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#sphereCollapse"
                    aria-expanded="false"
                    aria-controls="sphereCollapse"
                  >
                    Sphere Controls
                  </button>
                </h2>
                <div
                  id="sphereCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="sphereHeading"
                  data-bs-parent="#objectControls"
                >
                  <div class="accordion-body">
                    <!-- Radio buttons for sphere animation -->
                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate X-Axis</div>
                      <input
                        class="checkRadio"
                        id="sphere-x"
                        type="radio"
                        name="checkSphere"
                        checked
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Y-Axis</div>
                      <input
                        class="checkRadio"
                        id="sphere-y"
                        type="radio"
                        name="checkSphere"
                      />
                    </div>

                    <div class="param-panel horizontal-align mg-top-bottom">
                      <div class="checkText">Rotate Z-Axis</div>
                      <input
                        class="checkRadio"
                        id="sphere-z"
                        type="radio"
                        name="checkSphere"
                      />
                    </div>

                    <!-- Sphere animation button -->
                    <input
                      id="sphere-btn"
                      class="anim-btn"
                      type="button"
                      value="Toggle Sphere"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Lighting Controls -->
            <div class="accordion mt-3" id="lightingControls">
              <div class="accordion-item">
                <h2 class="accordion-header" id="lightingHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#lightingCollapse"
                    aria-expanded="false"
                    aria-controls="lightingCollapse"
                  >
                    Lighting Controls
                  </button>
                </h2>
                <div
                  id="lightingCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="lightingHeading"
                  data-bs-parent="#lightingControls"
                >
                  <div class="accordion-body">
                    <!-- Light Type -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Light Type</div>
                      <div class="horizontal-align">
                        <label>Directional</label>
                        <input
                          class="checkRadio"
                          id="directional-light"
                          type="radio"
                          name="light-type"
                          checked
                        />
                      </div>
                      <div class="horizontal-align">
                        <label>Point</label>
                        <input
                          class="checkRadio"
                          id="point-light"
                          type="radio"
                          name="light-type"
                        />
                      </div>
                      <div class="horizontal-align">
                        <label>Spotlight</label>
                        <input
                          class="checkRadio"
                          id="spotlight"
                          type="radio"
                          name="light-type"
                        />
                      </div>
                    </div>

                    <!-- Light Position -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Light Position</div>
                      <div class="slider-control horizontal-align">
                        <label>X:</label>
                        <input
                          type="range"
                          id="light-x"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="light-x-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Y:</label>
                        <input
                          type="range"
                          id="light-y"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="light-y-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Z:</label>
                        <input
                          type="range"
                          id="light-z"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="light-z-value">0.0</span>
                      </div>
                    </div>

                    <!-- Spotlight Direction -->
                    <div
                      class="param-panel vertical-align mg-top-bottom"
                      id="spotlight-controls"
                    >
                      <div class="checkText">Spotlight Direction</div>
                      <div class="direction-control horizontal-align">
                        <label>X:</label>
                        <input
                          type="range"
                          id="spotlight-x"
                          min="-1"
                          max="1"
                          step="0.1"
                          value="0"
                        />
                        <span id="spotlight-x-value">0.0</span>
                      </div>
                      <div class="direction-control horizontal-align">
                        <label>Y:</label>
                        <input
                          type="range"
                          id="spotlight-y"
                          min="-1"
                          max="1"
                          step="0.1"
                          value="-1"
                        />
                        <span id="spotlight-y-value">-1.0</span>
                      </div>
                      <div class="direction-control horizontal-align">
                        <label>Z:</label>
                        <input
                          type="range"
                          id="spotlight-z"
                          min="-1"
                          max="1"
                          step="0.1"
                          value="0"
                        />
                        <span id="spotlight-z-value">0.0</span>
                      </div>
                    </div>

                    <!-- Spotlight Cutoff -->
                    <div
                      class="param-panel vertical-align mg-top-bottom"
                      id="spotlight-cutoff-control"
                    >
                      <div class="checkText">Spotlight Cutoff</div>
                      <div class="slider-control horizontal-align">
                        <label>Angle:</label>
                        <input
                          type="range"
                          id="spotlight-cutoff"
                          min="0"
                          max="90"
                          step="1"
                          value="20"
                        />
                        <span id="spotlight-cutoff-value">20Â°</span>
                      </div>
                    </div>

                    <!-- Light Color -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Light Color</div>
                      <div class="color-control horizontal-align">
                        <label>Color:</label>
                        <input type="color" id="light-color" value="#ffffff" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Material Controls -->
            <div class="accordion mt-3" id="materialControls">
              <div class="accordion-item">
                <h2 class="accordion-header" id="materialHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#materialCollapse"
                    aria-expanded="false"
                    aria-controls="materialCollapse"
                  >
                    Material Controls
                  </button>
                </h2>
                <div
                  id="materialCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="materialHeading"
                  data-bs-parent="#materialControls"
                >
                  <div class="accordion-body">
                    <!-- Material Type -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Material Type</div>
                      <div class="horizontal-align">
                        <label>Plastic</label>
                        <input
                          class="checkRadio"
                          id="plastic-material"
                          type="radio"
                          name="material-type"
                          checked
                        />
                      </div>
                      <div class="horizontal-align">
                        <label>Metal</label>
                        <input
                          class="checkRadio"
                          id="metal-material"
                          type="radio"
                          name="material-type"
                        />
                      </div>
                      <div class="horizontal-align">
                        <label>Wood</label>
                        <input
                          class="checkRadio"
                          id="wood-material"
                          type="radio"
                          name="material-type"
                        />
                      </div>
                    </div>

                    <!-- Material Color -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Material Color</div>
                      <div class="color-control horizontal-align">
                        <label>Color:</label>
                        <input
                          type="color"
                          id="material-color"
                          value="#ff0000"
                        />
                      </div>
                    </div>

                    <!-- Shininess -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Shininess</div>
                      <div class="slider-control horizontal-align">
                        <label>Value:</label>
                        <input
                          type="range"
                          id="shininess"
                          min="1"
                          max="100"
                          step="1"
                          value="30"
                        />
                        <span id="shininess-value">30</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Camera Controls -->
            <div class="accordion mt-3" id="cameraControls">
              <div class="accordion-item">
                <h2 class="accordion-header" id="cameraHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#cameraCollapse"
                    aria-expanded="false"
                    aria-controls="cameraCollapse"
                  >
                    Camera Controls
                  </button>
                </h2>
                <div
                  id="cameraCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="cameraHeading"
                  data-bs-parent="#cameraControls"
                >
                  <div class="accordion-body">
                    <!-- Camera Position -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Camera Position</div>
                      <div class="slider-control horizontal-align">
                        <label>X:</label>
                        <input
                          type="range"
                          id="camera-x"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="camera-x-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Y:</label>
                        <input
                          type="range"
                          id="camera-y"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="camera-y-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Z:</label>
                        <input
                          type="range"
                          id="camera-z"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="5"
                        />
                        <span id="camera-z-value">5.0</span>
                      </div>
                    </div>

                    <!-- Look At Point -->
                    <div class="param-panel vertical-align mg-top-bottom">
                      <div class="checkText">Look At Point</div>
                      <div class="slider-control horizontal-align">
                        <label>X:</label>
                        <input
                          type="range"
                          id="look-at-x"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="look-at-x-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Y:</label>
                        <input
                          type="range"
                          id="look-at-y"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="look-at-y-value">0.0</span>
                      </div>
                      <div class="slider-control horizontal-align">
                        <label>Z:</label>
                        <input
                          type="range"
                          id="look-at-z"
                          min="-10"
                          max="10"
                          step="0.1"
                          value="0"
                        />
                        <span id="look-at-z-value">0.0</span>
                      </div>
                    </div>

                    <!-- Reset Camera Button -->
                    <div class="slider-control horizontal-align">
                      <input
                        type="button"
                        id="reset-camera"
                        value="Reset Camera"
                        class="anim-btn"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Shading Controls -->
            <div class="accordion mt-3" id="shadingControls">
              <div class="accordion-item">
                <h2 class="accordion-header" id="shadingHeading">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#shadingCollapse"
                    aria-expanded="false"
                    aria-controls="shadingCollapse"
                  >
                    Shading Controls
                  </button>
                </h2>
                <div
                  id="shadingCollapse"
                  class="accordion-collapse collapse"
                  aria-labelledby="shadingHeading"
                  data-bs-parent="#shadingControls"
                >
                  <div class="accordion-body">
                    <!-- Shading Type -->
                    <div class="shading-type horizontal-align">
                      <label>Shading Mode:</label>
                      <select id="shading-mode" class="form-select">
                        <option value="smooth">Smooth</option>
                        <option value="flat">Flat</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
